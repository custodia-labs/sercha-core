basePath: /api/v1
definitions:
  domain.AIProvider:
    enum:
    - openai
    - anthropic
    - ollama
    - cohere
    - voyage
    type: string
    x-enum-varnames:
    - AIProviderOpenAI
    - AIProviderAnthropic
    - AIProviderOllama
    - AIProviderCohere
    - AIProviderVoyage
  domain.Chunk:
    properties:
      content:
        type: string
      created_at:
        type: string
      document_id:
        type: string
      embedding:
        items:
          type: number
        type: array
      end_char:
        type: integer
      id:
        type: string
      position:
        description: Chunk position within document
        type: integer
      source_id:
        type: string
      start_char:
        type: integer
    type: object
  domain.Document:
    properties:
      created_at:
        type: string
      external_id:
        description: ID from the source system
        type: string
      id:
        type: string
      indexed_at:
        type: string
      metadata:
        additionalProperties:
          type: string
        type: object
      mime_type:
        type: string
      path:
        description: Path or URL in source
        type: string
      source_id:
        type: string
      title:
        type: string
      updated_at:
        type: string
    type: object
  domain.DocumentWithChunks:
    properties:
      chunks:
        items:
          $ref: '#/definitions/domain.Chunk'
        type: array
      document:
        $ref: '#/definitions/domain.Document'
    type: object
  domain.LoginRequest:
    properties:
      email:
        type: string
      password:
        type: string
    type: object
  domain.LoginResponse:
    properties:
      expires_at:
        type: string
      refresh_token:
        type: string
      token:
        type: string
      user:
        $ref: '#/definitions/domain.UserSummary'
    type: object
  domain.ProviderType:
    enum:
    - github
    - gitlab
    - bitbucket
    - slack
    - discord
    - msteams
    - notion
    - confluence
    - google_docs
    - jira
    - linear
    - google_drive
    - dropbox
    - onedrive
    - s3
    - zendesk
    - intercom
    type: string
    x-enum-varnames:
    - ProviderTypeGitHub
    - ProviderTypeGitLab
    - ProviderTypeBitbucket
    - ProviderTypeSlack
    - ProviderTypeDiscord
    - ProviderTypeMSTeams
    - ProviderTypeNotion
    - ProviderTypeConfluence
    - ProviderTypeGoogleDocs
    - ProviderTypeJira
    - ProviderTypeLinear
    - ProviderTypeGoogleDrive
    - ProviderTypeDropbox
    - ProviderTypeOneDrive
    - ProviderTypeS3
    - ProviderTypeZendesk
    - ProviderTypeIntercom
  domain.RankedChunk:
    properties:
      chunk:
        $ref: '#/definitions/domain.Chunk'
      document:
        $ref: '#/definitions/domain.Document'
      highlights:
        description: Highlighted snippets
        items:
          type: string
        type: array
      score:
        type: number
    type: object
  domain.RefreshRequest:
    properties:
      refresh_token:
        type: string
    type: object
  domain.Role:
    enum:
    - admin
    - member
    - viewer
    type: string
    x-enum-comments:
      RoleAdmin: Manage users, sources, settings
      RoleMember: Search, view documents
      RoleViewer: Search only (future)
    x-enum-descriptions:
    - Manage users, sources, settings
    - Search, view documents
    - Search only (future)
    x-enum-varnames:
    - RoleAdmin
    - RoleMember
    - RoleViewer
  domain.SearchMode:
    enum:
    - hybrid
    - text
    - semantic
    type: string
    x-enum-comments:
      SearchModeHybrid: BM25 + vector (default)
      SearchModeSemanticOnly: Vector only
      SearchModeTextOnly: BM25 only
    x-enum-descriptions:
    - BM25 + vector (default)
    - BM25 only
    - Vector only
    x-enum-varnames:
    - SearchModeHybrid
    - SearchModeTextOnly
    - SearchModeSemanticOnly
  domain.SearchResult:
    properties:
      mode:
        $ref: '#/definitions/domain.SearchMode'
      query:
        type: string
      results:
        items:
          $ref: '#/definitions/domain.RankedChunk'
        type: array
      took:
        example: 1500000
        type: integer
      total_count:
        type: integer
    type: object
  domain.Settings:
    properties:
      ai_endpoint:
        description: For self-hosted (Ollama)
        type: string
      ai_provider:
        allOf:
        - $ref: '#/definitions/domain.AIProvider'
        description: AI Configuration
      auto_suggest_enabled:
        type: boolean
      default_search_mode:
        allOf:
        - $ref: '#/definitions/domain.SearchMode'
        description: Search Defaults
      embedding_model:
        type: string
      max_results_per_page:
        type: integer
      results_per_page:
        type: integer
      semantic_search_enabled:
        description: Feature Flags
        type: boolean
      sync_enabled:
        type: boolean
      sync_interval_minutes:
        description: Sync Configuration
        type: integer
      team_id:
        type: string
      updated_at:
        description: Metadata
        type: string
      updated_by:
        description: User ID
        type: string
    type: object
  domain.Source:
    properties:
      config:
        $ref: '#/definitions/domain.SourceConfig'
      created_at:
        type: string
      created_by:
        description: User ID of creator
        type: string
      enabled:
        type: boolean
      id:
        type: string
      name:
        type: string
      provider_type:
        $ref: '#/definitions/domain.ProviderType'
      updated_at:
        type: string
    type: object
  domain.SourceConfig:
    properties:
      base_url:
        description: Generic
        type: string
      branch:
        type: string
      channels:
        description: Slack
        items:
          type: string
        type: array
      credential_id:
        description: Common fields
        type: string
      database_ids:
        description: Notion
        items:
          type: string
        type: array
      extra:
        additionalProperties:
          type: string
        type: object
      folder_ids:
        description: Google Drive
        items:
          type: string
        type: array
      jql:
        type: string
      owner:
        description: GitHub/GitLab
        type: string
      page_ids:
        items:
          type: string
        type: array
      paths:
        items:
          type: string
        type: array
      project_keys:
        description: Jira
        items:
          type: string
        type: array
      repository:
        type: string
      space_keys:
        description: Confluence
        items:
          type: string
        type: array
    type: object
  domain.SourceSummary:
    properties:
      document_count:
        type: integer
      last_sync_at:
        type: string
      source:
        $ref: '#/definitions/domain.Source'
      sync_status:
        type: string
    type: object
  domain.User:
    properties:
      active:
        type: boolean
      created_at:
        type: string
      email:
        type: string
      id:
        type: string
      last_login_at:
        type: string
      name:
        type: string
      role:
        $ref: '#/definitions/domain.Role'
      team_id:
        type: string
      updated_at:
        type: string
    type: object
  domain.UserSummary:
    properties:
      active:
        type: boolean
      email:
        type: string
      id:
        type: string
      last_login_at:
        type: string
      name:
        type: string
      role:
        $ref: '#/definitions/domain.Role'
    type: object
  domain.VespaClusterInfo:
    properties:
      container_clusters:
        items:
          $ref: '#/definitions/domain.VespaContainerCluster'
        type: array
      content_clusters:
        description: Parsed cluster information
        items:
          $ref: '#/definitions/domain.VespaContentCluster'
        type: array
      hosts:
        items:
          $ref: '#/definitions/domain.VespaHost'
        type: array
      hosts_xml:
        type: string
      our_schema_deployed:
        description: Our schema status
        type: boolean
      schemas:
        items:
          type: string
        type: array
      services_xml:
        description: Raw XML content (for persistence and future reference)
        type: string
    type: object
  domain.VespaContainerCluster:
    properties:
      has_feed:
        type: boolean
      has_query:
        type: boolean
      id:
        type: string
      nodes:
        items:
          type: string
        type: array
      port:
        type: integer
    type: object
  domain.VespaContentCluster:
    properties:
      documents:
        items:
          type: string
        type: array
      id:
        type: string
      nodes:
        items:
          type: string
        type: array
      redundancy:
        type: integer
    type: object
  domain.VespaHost:
    properties:
      alias:
        type: string
      hostname:
        type: string
    type: object
  domain.VespaSchemaMode:
    enum:
    - ""
    - bm25
    - hybrid
    type: string
    x-enum-varnames:
    - VespacSchemaModeNone
    - VespacSchemaModeBM25
    - VespacSchemaModeHybrid
  driving.AIServiceStatus:
    properties:
      available:
        type: boolean
      embedding_dim:
        description: Only for embedding service
        type: integer
      model:
        type: string
      provider:
        $ref: '#/definitions/domain.AIProvider'
    type: object
  driving.AISettingsStatus:
    properties:
      effective_search_mode:
        $ref: '#/definitions/domain.SearchMode'
      embedding:
        $ref: '#/definitions/driving.AIServiceStatus'
      llm:
        $ref: '#/definitions/driving.AIServiceStatus'
      vespa:
        $ref: '#/definitions/driving.VespaServiceStatus'
    type: object
  driving.ConnectVespaRequest:
    properties:
      dev_mode:
        description: |-
          DevMode controls deployment behavior:
          - true: Deploy our full app package (services.xml + schema) - for local development
          - false: Fetch existing app package, add our schema, redeploy - for production clusters
        type: boolean
      endpoint:
        description: Endpoint is the Vespa cluster endpoint (optional, uses stored/default
          if empty)
        type: string
    type: object
  driving.CreateSourceRequest:
    properties:
      config:
        $ref: '#/definitions/domain.SourceConfig'
      name:
        type: string
      provider_type:
        $ref: '#/definitions/domain.ProviderType'
    type: object
  driving.CreateUserRequest:
    properties:
      email:
        type: string
      name:
        type: string
      password:
        type: string
      role:
        $ref: '#/definitions/domain.Role'
    type: object
  driving.EmbeddingSettingsInput:
    properties:
      api_key:
        type: string
      base_url:
        type: string
      model:
        type: string
      provider:
        $ref: '#/definitions/domain.AIProvider'
    type: object
  driving.LLMSettingsInput:
    properties:
      api_key:
        type: string
      base_url:
        type: string
      model:
        type: string
      provider:
        $ref: '#/definitions/domain.AIProvider'
    type: object
  driving.SetupRequest:
    properties:
      email:
        type: string
      name:
        type: string
      password:
        type: string
    type: object
  driving.SetupResponse:
    properties:
      message:
        type: string
      user:
        $ref: '#/definitions/domain.User'
    type: object
  driving.UpdateAISettingsRequest:
    properties:
      embedding:
        $ref: '#/definitions/driving.EmbeddingSettingsInput'
      llm:
        $ref: '#/definitions/driving.LLMSettingsInput'
    type: object
  driving.UpdateSettingsRequest:
    properties:
      ai_endpoint:
        type: string
      ai_provider:
        $ref: '#/definitions/domain.AIProvider'
      auto_suggest_enabled:
        type: boolean
      default_search_mode:
        $ref: '#/definitions/domain.SearchMode'
      embedding_model:
        type: string
      results_per_page:
        type: integer
      semantic_search_enabled:
        type: boolean
      sync_enabled:
        type: boolean
      sync_interval_minutes:
        type: integer
    type: object
  driving.VespaServiceStatus:
    properties:
      can_upgrade:
        type: boolean
      connected:
        type: boolean
      embedding_dim:
        type: integer
      embeddings_enabled:
        type: boolean
      healthy:
        type: boolean
      schema_mode:
        $ref: '#/definitions/domain.VespaSchemaMode'
    type: object
  driving.VespaStatus:
    properties:
      can_upgrade:
        description: CanUpgrade indicates if schema can be upgraded to hybrid
        type: boolean
      cluster_info:
        allOf:
        - $ref: '#/definitions/domain.VespaClusterInfo'
        description: ClusterInfo contains parsed information about the Vespa cluster
          (production mode only)
      connected:
        description: Connected indicates if Vespa is reachable and schema is deployed
        type: boolean
      dev_mode:
        description: DevMode indicates if we deployed full app package (true) or just
          added schema (false)
        type: boolean
      embedding_dim:
        description: EmbeddingDim is the embedding dimension if embeddings are enabled
        type: integer
      embedding_provider:
        allOf:
        - $ref: '#/definitions/domain.AIProvider'
        description: EmbeddingProvider is the provider used for embeddings
      embeddings_enabled:
        description: EmbeddingsEnabled indicates if hybrid search is available
        type: boolean
      endpoint:
        description: Endpoint is the Vespa cluster endpoint
        type: string
      healthy:
        description: Healthy indicates if the Vespa cluster is healthy
        type: boolean
      reindex_required:
        description: ReindexRequired indicates if documents need reindexing
        type: boolean
      schema_mode:
        allOf:
        - $ref: '#/definitions/domain.VespaSchemaMode'
        description: SchemaMode indicates the deployed schema type (bm25, hybrid)
      schema_version:
        description: SchemaVersion is the deployed schema version
        type: string
    type: object
  http.ErrorResponse:
    description: API error response
    properties:
      error:
        example: invalid request body
        type: string
    type: object
  http.StatusResponse:
    description: Simple status response
    properties:
      status:
        example: ok
        type: string
    type: object
  http.SyncAcceptedResponse:
    description: Sync accepted response
    properties:
      source_id:
        example: src_abc123
        type: string
      status:
        example: accepted
        type: string
    type: object
  http.VersionResponse:
    description: API version response
    properties:
      version:
        example: 1.0.0
        type: string
    type: object
  http.aiProviderInfo:
    description: AI provider configuration status
    properties:
      base_url:
        example: https://api.openai.com/v1
        type: string
      has_api_key:
        example: true
        type: boolean
      is_configured:
        example: true
        type: boolean
      model:
        example: text-embedding-3-small
        type: string
      provider:
        allOf:
        - $ref: '#/definitions/domain.AIProvider'
        example: openai
    type: object
  http.aiSettingsResponse:
    properties:
      embedding:
        $ref: '#/definitions/http.aiProviderInfo'
      llm:
        $ref: '#/definitions/http.aiProviderInfo'
    type: object
  http.searchRequest:
    description: Search query request
    properties:
      limit:
        example: 20
        type: integer
      mode:
        allOf:
        - $ref: '#/definitions/domain.SearchMode'
        enum:
        - hybrid
        - text
        - semantic
        example: hybrid
      offset:
        example: 0
        type: integer
      query:
        example: how to configure authentication
        type: string
      source_ids:
        items:
          type: string
        type: array
    type: object
host: localhost:8081
info:
  contact:
    email: support@custodialabs.com
    name: Custodia Labs
    url: https://custodialabs.com
  description: Privacy-focused enterprise search API. Sercha Core provides full-text
    and semantic search across your connected data sources.
  license:
    name: Apache 2.0
    url: http://www.apache.org/licenses/LICENSE-2.0.html
  title: Sercha Core API
  version: "1.0"
paths:
  /admin/vespa/connect:
    post:
      consumes:
      - application/json
      description: Connect to a Vespa cluster and deploy the search schema (admin
        only). Use dev_mode=true for local development, dev_mode=false for production
        clusters.
      parameters:
      - description: Vespa connection settings
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/driving.ConnectVespaRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/driving.VespaStatus'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Connection failed
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Connect to Vespa
      tags:
      - Vespa
  /admin/vespa/health:
    get:
      description: Check if the Vespa cluster is healthy (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "503":
          description: Vespa unhealthy
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Vespa health check
      tags:
      - Vespa
  /admin/vespa/status:
    get:
      description: Get the current Vespa connection and schema status (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/driving.VespaStatus'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get Vespa status
      tags:
      - Vespa
  /auth/login:
    post:
      consumes:
      - application/json
      description: Authenticate with email and password to receive a JWT token
      parameters:
      - description: Login credentials
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/domain.LoginRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.LoginResponse'
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Invalid credentials or account disabled
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      summary: User login
      tags:
      - Authentication
  /auth/logout:
    post:
      description: Invalidate the current session token
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
      security:
      - BearerAuth: []
      summary: Logout user
      tags:
      - Authentication
  /auth/refresh:
    post:
      consumes:
      - application/json
      description: Exchange a refresh token for a new JWT token
      parameters:
      - description: Refresh token
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/domain.RefreshRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.LoginResponse'
        "400":
          description: Invalid request body
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Invalid refresh token
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      summary: Refresh token
      tags:
      - Authentication
  /documents/{id}:
    get:
      description: Get a document by ID with all its chunks
      parameters:
      - description: Document ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.DocumentWithChunks'
        "400":
          description: Missing document ID
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "404":
          description: Document not found
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get document
      tags:
      - Documents
  /health:
    get:
      description: Returns the health status of the API
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
      summary: Health check
      tags:
      - Health
  /me:
    get:
      description: Get the currently authenticated user's profile
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.UserSummary'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get current user
      tags:
      - Users
  /ready:
    get:
      description: Returns the readiness status of the API (checks database and service
        connections)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
      summary: Readiness check
      tags:
      - Health
  /search:
    post:
      consumes:
      - application/json
      description: Execute a search query across all indexed documents. Supports hybrid
        (BM25 + semantic), text-only, and semantic-only modes.
      parameters:
      - description: Search query
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/http.searchRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.SearchResult'
        "400":
          description: Invalid request or missing query
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Search failed
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Search documents
      tags:
      - Search
  /settings:
    get:
      description: Get system settings (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Settings'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get settings
      tags:
      - Settings
    put:
      consumes:
      - application/json
      description: Update system settings (admin only)
      parameters:
      - description: Settings to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/driving.UpdateSettingsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Settings'
        "400":
          description: Invalid request
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update settings
      tags:
      - Settings
  /settings/ai:
    get:
      description: Get AI provider configuration (admin only). API keys are masked.
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.aiSettingsResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get AI settings
      tags:
      - AI Settings
    put:
      consumes:
      - application/json
      description: Update AI provider configuration (admin only). This triggers hot-reload
        of AI services.
      parameters:
      - description: AI settings to update
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/driving.UpdateAISettingsRequest'
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/driving.AISettingsStatus'
        "400":
          description: Invalid configuration or unsupported provider
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Update AI settings
      tags:
      - AI Settings
  /settings/ai/status:
    get:
      description: Get the current status of AI services including embedding, LLM,
        and Vespa connection status
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/driving.AISettingsStatus'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get AI status
      tags:
      - AI Settings
  /settings/ai/test:
    post:
      description: Test connectivity to configured AI providers (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "503":
          description: AI service unavailable
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Test AI connection
      tags:
      - AI Settings
  /setup:
    post:
      consumes:
      - application/json
      description: Create the initial admin user. This endpoint can only be called
        once when no users exist.
      parameters:
      - description: Admin user details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/driving.SetupRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/driving.SetupResponse'
        "400":
          description: Invalid input
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Setup already complete
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Setup failed
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      summary: Initial setup
      tags:
      - Setup
  /sources:
    get:
      description: Get a list of all configured data sources with sync status
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.SourceSummary'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List sources
      tags:
      - Sources
    post:
      consumes:
      - application/json
      description: Create a new data source (admin only)
      parameters:
      - description: Source configuration
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/driving.CreateSourceRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/domain.Source'
        "400":
          description: Invalid input
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "409":
          description: Source already exists
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create source
      tags:
      - Sources
  /sources/{id}:
    delete:
      description: Delete a data source by ID (admin only). This also removes all
        indexed documents from this source.
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
        "400":
          description: Missing source ID
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "404":
          description: Source not found
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete source
      tags:
      - Sources
    get:
      description: Get a data source by ID
      parameters:
      - description: Source ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/domain.Source'
        "400":
          description: Missing source ID
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "404":
          description: Source not found
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Get source
      tags:
      - Sources
  /sync/{sourceId}:
    post:
      description: Trigger a sync operation for a specific source (admin only)
      parameters:
      - description: Source ID
        in: path
        name: sourceId
        required: true
        type: string
      produces:
      - application/json
      responses:
        "202":
          description: Accepted
          schema:
            $ref: '#/definitions/http.SyncAcceptedResponse'
        "400":
          description: Missing source ID
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Trigger sync
      tags:
      - Sync
  /users:
    get:
      description: Get a list of all users (admin only)
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            items:
              $ref: '#/definitions/domain.UserSummary'
            type: array
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: List all users
      tags:
      - Users
    post:
      consumes:
      - application/json
      description: Create a new user (admin only)
      parameters:
      - description: User details
        in: body
        name: request
        required: true
        schema:
          $ref: '#/definitions/driving.CreateUserRequest'
      produces:
      - application/json
      responses:
        "201":
          description: Created
          schema:
            $ref: '#/definitions/domain.UserSummary'
        "400":
          description: Invalid input
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "409":
          description: User already exists
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Create user
      tags:
      - Users
  /users/{id}:
    delete:
      description: Delete a user by ID (admin only)
      parameters:
      - description: User ID
        in: path
        name: id
        required: true
        type: string
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.StatusResponse'
        "400":
          description: Missing user ID
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "401":
          description: Unauthorized
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "403":
          description: Forbidden - admin only
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "404":
          description: User not found
          schema:
            $ref: '#/definitions/http.ErrorResponse'
        "500":
          description: Internal server error
          schema:
            $ref: '#/definitions/http.ErrorResponse'
      security:
      - BearerAuth: []
      summary: Delete user
      tags:
      - Users
  /version:
    get:
      description: Returns the current API version
      produces:
      - application/json
      responses:
        "200":
          description: OK
          schema:
            $ref: '#/definitions/http.VersionResponse'
      summary: Get API version
      tags:
      - Health
schemes:
- http
- https
securityDefinitions:
  BearerAuth:
    description: 'JWT Bearer token. Format: "Bearer {token}"'
    in: header
    name: Authorization
    type: apiKey
swagger: "2.0"
