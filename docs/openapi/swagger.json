{
    "schemes": [
        "http",
        "https"
    ],
    "swagger": "2.0",
    "info": {
        "description": "Privacy-focused enterprise search API. Sercha Core provides full-text and semantic search across your connected data sources.",
        "title": "Sercha Core API",
        "contact": {
            "name": "Custodia Labs",
            "url": "https://custodialabs.com",
            "email": "support@custodialabs.com"
        },
        "license": {
            "name": "Apache 2.0",
            "url": "http://www.apache.org/licenses/LICENSE-2.0.html"
        },
        "version": "1.0"
    },
    "host": "localhost:8081",
    "basePath": "/api/v1",
    "paths": {
        "/admin/vespa/connect": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Connect to a Vespa cluster and deploy the search schema (admin only). Use dev_mode=true for local development, dev_mode=false for production clusters.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Vespa"
                ],
                "summary": "Connect to Vespa",
                "parameters": [
                    {
                        "description": "Vespa connection settings",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/driving.ConnectVespaRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/driving.VespaStatus"
                        }
                    },
                    "400": {
                        "description": "Invalid request",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Connection failed",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/admin/vespa/health": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Check if the Vespa cluster is healthy (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Vespa"
                ],
                "summary": "Vespa health check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "Vespa unhealthy",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/admin/vespa/status": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get the current Vespa connection and schema status (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Vespa"
                ],
                "summary": "Get Vespa status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/driving.VespaStatus"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/login": {
            "post": {
                "description": "Authenticate with email and password to receive a JWT token",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Authentication"
                ],
                "summary": "User login",
                "parameters": [
                    {
                        "description": "Login credentials",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/domain.LoginRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.LoginResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid request body",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Invalid credentials or account disabled",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/auth/logout": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Invalidate the current session token",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Authentication"
                ],
                "summary": "Logout user",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    }
                }
            }
        },
        "/auth/refresh": {
            "post": {
                "description": "Exchange a refresh token for a new JWT token",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Authentication"
                ],
                "summary": "Refresh token",
                "parameters": [
                    {
                        "description": "Refresh token",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/domain.RefreshRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.LoginResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid request body",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Invalid refresh token",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/documents/{id}": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get a document by ID with all its chunks",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Documents"
                ],
                "summary": "Get document",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Document ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.DocumentWithChunks"
                        }
                    },
                    "400": {
                        "description": "Missing document ID",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Document not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/health": {
            "get": {
                "description": "Returns the health status of the API",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Health"
                ],
                "summary": "Health check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    }
                }
            }
        },
        "/me": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get the currently authenticated user's profile",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Users"
                ],
                "summary": "Get current user",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.UserSummary"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/ready": {
            "get": {
                "description": "Returns the readiness status of the API (checks database and service connections)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Health"
                ],
                "summary": "Readiness check",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    }
                }
            }
        },
        "/search": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Execute a search query across all indexed documents. Supports hybrid (BM25 + semantic), text-only, and semantic-only modes.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Search"
                ],
                "summary": "Search documents",
                "parameters": [
                    {
                        "description": "Search query",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/http.searchRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.SearchResult"
                        }
                    },
                    "400": {
                        "description": "Invalid request or missing query",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Search failed",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/settings": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get system settings (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Settings"
                ],
                "summary": "Get settings",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.Settings"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            },
            "put": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Update system settings (admin only)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Settings"
                ],
                "summary": "Update settings",
                "parameters": [
                    {
                        "description": "Settings to update",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/driving.UpdateSettingsRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.Settings"
                        }
                    },
                    "400": {
                        "description": "Invalid request",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/settings/ai": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get AI provider configuration (admin only). API keys are masked.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "AI Settings"
                ],
                "summary": "Get AI settings",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.aiSettingsResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            },
            "put": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Update AI provider configuration (admin only). This triggers hot-reload of AI services.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "AI Settings"
                ],
                "summary": "Update AI settings",
                "parameters": [
                    {
                        "description": "AI settings to update",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/driving.UpdateAISettingsRequest"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/driving.AISettingsStatus"
                        }
                    },
                    "400": {
                        "description": "Invalid configuration or unsupported provider",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/settings/ai/status": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get the current status of AI services including embedding, LLM, and Vespa connection status",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "AI Settings"
                ],
                "summary": "Get AI status",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/driving.AISettingsStatus"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/settings/ai/test": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Test connectivity to configured AI providers (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "AI Settings"
                ],
                "summary": "Test AI connection",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "503": {
                        "description": "AI service unavailable",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/setup": {
            "post": {
                "description": "Create the initial admin user. This endpoint can only be called once when no users exist.",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Setup"
                ],
                "summary": "Initial setup",
                "parameters": [
                    {
                        "description": "Admin user details",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/driving.SetupRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/driving.SetupResponse"
                        }
                    },
                    "400": {
                        "description": "Invalid input",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Setup already complete",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Setup failed",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/sources": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get a list of all configured data sources with sync status",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Sources"
                ],
                "summary": "List sources",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/domain.SourceSummary"
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Create a new data source (admin only)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Sources"
                ],
                "summary": "Create source",
                "parameters": [
                    {
                        "description": "Source configuration",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/driving.CreateSourceRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/domain.Source"
                        }
                    },
                    "400": {
                        "description": "Invalid input",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "409": {
                        "description": "Source already exists",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/sources/{id}": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get a data source by ID",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Sources"
                ],
                "summary": "Get source",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Source ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/domain.Source"
                        }
                    },
                    "400": {
                        "description": "Missing source ID",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Source not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            },
            "delete": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Delete a data source by ID (admin only). This also removes all indexed documents from this source.",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Sources"
                ],
                "summary": "Delete source",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Source ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Missing source ID",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "Source not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/sync/{sourceId}": {
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Trigger a sync operation for a specific source (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Sync"
                ],
                "summary": "Trigger sync",
                "parameters": [
                    {
                        "type": "string",
                        "description": "Source ID",
                        "name": "sourceId",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "202": {
                        "description": "Accepted",
                        "schema": {
                            "$ref": "#/definitions/http.SyncAcceptedResponse"
                        }
                    },
                    "400": {
                        "description": "Missing source ID",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/users": {
            "get": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Get a list of all users (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Users"
                ],
                "summary": "List all users",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "type": "array",
                            "items": {
                                "$ref": "#/definitions/domain.UserSummary"
                            }
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            },
            "post": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Create a new user (admin only)",
                "consumes": [
                    "application/json"
                ],
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Users"
                ],
                "summary": "Create user",
                "parameters": [
                    {
                        "description": "User details",
                        "name": "request",
                        "in": "body",
                        "required": true,
                        "schema": {
                            "$ref": "#/definitions/driving.CreateUserRequest"
                        }
                    }
                ],
                "responses": {
                    "201": {
                        "description": "Created",
                        "schema": {
                            "$ref": "#/definitions/domain.UserSummary"
                        }
                    },
                    "400": {
                        "description": "Invalid input",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "409": {
                        "description": "User already exists",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/users/{id}": {
            "delete": {
                "security": [
                    {
                        "BearerAuth": []
                    }
                ],
                "description": "Delete a user by ID (admin only)",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Users"
                ],
                "summary": "Delete user",
                "parameters": [
                    {
                        "type": "string",
                        "description": "User ID",
                        "name": "id",
                        "in": "path",
                        "required": true
                    }
                ],
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.StatusResponse"
                        }
                    },
                    "400": {
                        "description": "Missing user ID",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "401": {
                        "description": "Unauthorized",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "403": {
                        "description": "Forbidden - admin only",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "404": {
                        "description": "User not found",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    },
                    "500": {
                        "description": "Internal server error",
                        "schema": {
                            "$ref": "#/definitions/http.ErrorResponse"
                        }
                    }
                }
            }
        },
        "/version": {
            "get": {
                "description": "Returns the current API version",
                "produces": [
                    "application/json"
                ],
                "tags": [
                    "Health"
                ],
                "summary": "Get API version",
                "responses": {
                    "200": {
                        "description": "OK",
                        "schema": {
                            "$ref": "#/definitions/http.VersionResponse"
                        }
                    }
                }
            }
        }
    },
    "definitions": {
        "domain.AIProvider": {
            "type": "string",
            "enum": [
                "openai",
                "anthropic",
                "ollama",
                "cohere",
                "voyage"
            ],
            "x-enum-varnames": [
                "AIProviderOpenAI",
                "AIProviderAnthropic",
                "AIProviderOllama",
                "AIProviderCohere",
                "AIProviderVoyage"
            ]
        },
        "domain.Chunk": {
            "type": "object",
            "properties": {
                "content": {
                    "type": "string"
                },
                "created_at": {
                    "type": "string"
                },
                "document_id": {
                    "type": "string"
                },
                "embedding": {
                    "type": "array",
                    "items": {
                        "type": "number"
                    }
                },
                "end_char": {
                    "type": "integer"
                },
                "id": {
                    "type": "string"
                },
                "position": {
                    "description": "Chunk position within document",
                    "type": "integer"
                },
                "source_id": {
                    "type": "string"
                },
                "start_char": {
                    "type": "integer"
                }
            }
        },
        "domain.Document": {
            "type": "object",
            "properties": {
                "created_at": {
                    "type": "string"
                },
                "external_id": {
                    "description": "ID from the source system",
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "indexed_at": {
                    "type": "string"
                },
                "metadata": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "mime_type": {
                    "type": "string"
                },
                "path": {
                    "description": "Path or URL in source",
                    "type": "string"
                },
                "source_id": {
                    "type": "string"
                },
                "title": {
                    "type": "string"
                },
                "updated_at": {
                    "type": "string"
                }
            }
        },
        "domain.DocumentWithChunks": {
            "type": "object",
            "properties": {
                "chunks": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.Chunk"
                    }
                },
                "document": {
                    "$ref": "#/definitions/domain.Document"
                }
            }
        },
        "domain.LoginRequest": {
            "type": "object",
            "properties": {
                "email": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                }
            }
        },
        "domain.LoginResponse": {
            "type": "object",
            "properties": {
                "expires_at": {
                    "type": "string"
                },
                "refresh_token": {
                    "type": "string"
                },
                "token": {
                    "type": "string"
                },
                "user": {
                    "$ref": "#/definitions/domain.UserSummary"
                }
            }
        },
        "domain.ProviderType": {
            "type": "string",
            "enum": [
                "github",
                "gitlab",
                "bitbucket",
                "slack",
                "discord",
                "msteams",
                "notion",
                "confluence",
                "google_docs",
                "jira",
                "linear",
                "google_drive",
                "dropbox",
                "onedrive",
                "s3",
                "zendesk",
                "intercom"
            ],
            "x-enum-varnames": [
                "ProviderTypeGitHub",
                "ProviderTypeGitLab",
                "ProviderTypeBitbucket",
                "ProviderTypeSlack",
                "ProviderTypeDiscord",
                "ProviderTypeMSTeams",
                "ProviderTypeNotion",
                "ProviderTypeConfluence",
                "ProviderTypeGoogleDocs",
                "ProviderTypeJira",
                "ProviderTypeLinear",
                "ProviderTypeGoogleDrive",
                "ProviderTypeDropbox",
                "ProviderTypeOneDrive",
                "ProviderTypeS3",
                "ProviderTypeZendesk",
                "ProviderTypeIntercom"
            ]
        },
        "domain.RankedChunk": {
            "type": "object",
            "properties": {
                "chunk": {
                    "$ref": "#/definitions/domain.Chunk"
                },
                "document": {
                    "$ref": "#/definitions/domain.Document"
                },
                "highlights": {
                    "description": "Highlighted snippets",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "score": {
                    "type": "number"
                }
            }
        },
        "domain.RefreshRequest": {
            "type": "object",
            "properties": {
                "refresh_token": {
                    "type": "string"
                }
            }
        },
        "domain.Role": {
            "type": "string",
            "enum": [
                "admin",
                "member",
                "viewer"
            ],
            "x-enum-comments": {
                "RoleAdmin": "Manage users, sources, settings",
                "RoleMember": "Search, view documents",
                "RoleViewer": "Search only (future)"
            },
            "x-enum-descriptions": [
                "Manage users, sources, settings",
                "Search, view documents",
                "Search only (future)"
            ],
            "x-enum-varnames": [
                "RoleAdmin",
                "RoleMember",
                "RoleViewer"
            ]
        },
        "domain.SearchMode": {
            "type": "string",
            "enum": [
                "hybrid",
                "text",
                "semantic"
            ],
            "x-enum-comments": {
                "SearchModeHybrid": "BM25 + vector (default)",
                "SearchModeSemanticOnly": "Vector only",
                "SearchModeTextOnly": "BM25 only"
            },
            "x-enum-descriptions": [
                "BM25 + vector (default)",
                "BM25 only",
                "Vector only"
            ],
            "x-enum-varnames": [
                "SearchModeHybrid",
                "SearchModeTextOnly",
                "SearchModeSemanticOnly"
            ]
        },
        "domain.SearchResult": {
            "type": "object",
            "properties": {
                "mode": {
                    "$ref": "#/definitions/domain.SearchMode"
                },
                "query": {
                    "type": "string"
                },
                "results": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.RankedChunk"
                    }
                },
                "took": {
                    "type": "integer",
                    "example": 1500000
                },
                "total_count": {
                    "type": "integer"
                }
            }
        },
        "domain.Settings": {
            "type": "object",
            "properties": {
                "ai_endpoint": {
                    "description": "For self-hosted (Ollama)",
                    "type": "string"
                },
                "ai_provider": {
                    "description": "AI Configuration",
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.AIProvider"
                        }
                    ]
                },
                "auto_suggest_enabled": {
                    "type": "boolean"
                },
                "default_search_mode": {
                    "description": "Search Defaults",
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.SearchMode"
                        }
                    ]
                },
                "embedding_model": {
                    "type": "string"
                },
                "max_results_per_page": {
                    "type": "integer"
                },
                "results_per_page": {
                    "type": "integer"
                },
                "semantic_search_enabled": {
                    "description": "Feature Flags",
                    "type": "boolean"
                },
                "sync_enabled": {
                    "type": "boolean"
                },
                "sync_interval_minutes": {
                    "description": "Sync Configuration",
                    "type": "integer"
                },
                "team_id": {
                    "type": "string"
                },
                "updated_at": {
                    "description": "Metadata",
                    "type": "string"
                },
                "updated_by": {
                    "description": "User ID",
                    "type": "string"
                }
            }
        },
        "domain.Source": {
            "type": "object",
            "properties": {
                "config": {
                    "$ref": "#/definitions/domain.SourceConfig"
                },
                "created_at": {
                    "type": "string"
                },
                "created_by": {
                    "description": "User ID of creator",
                    "type": "string"
                },
                "enabled": {
                    "type": "boolean"
                },
                "id": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "provider_type": {
                    "$ref": "#/definitions/domain.ProviderType"
                },
                "updated_at": {
                    "type": "string"
                }
            }
        },
        "domain.SourceConfig": {
            "type": "object",
            "properties": {
                "base_url": {
                    "description": "Generic",
                    "type": "string"
                },
                "branch": {
                    "type": "string"
                },
                "channels": {
                    "description": "Slack",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "credential_id": {
                    "description": "Common fields",
                    "type": "string"
                },
                "database_ids": {
                    "description": "Notion",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "extra": {
                    "type": "object",
                    "additionalProperties": {
                        "type": "string"
                    }
                },
                "folder_ids": {
                    "description": "Google Drive",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "jql": {
                    "type": "string"
                },
                "owner": {
                    "description": "GitHub/GitLab",
                    "type": "string"
                },
                "page_ids": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "paths": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "project_keys": {
                    "description": "Jira",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "repository": {
                    "type": "string"
                },
                "space_keys": {
                    "description": "Confluence",
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        },
        "domain.SourceSummary": {
            "type": "object",
            "properties": {
                "document_count": {
                    "type": "integer"
                },
                "last_sync_at": {
                    "type": "string"
                },
                "source": {
                    "$ref": "#/definitions/domain.Source"
                },
                "sync_status": {
                    "type": "string"
                }
            }
        },
        "domain.User": {
            "type": "object",
            "properties": {
                "active": {
                    "type": "boolean"
                },
                "created_at": {
                    "type": "string"
                },
                "email": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "last_login_at": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "role": {
                    "$ref": "#/definitions/domain.Role"
                },
                "team_id": {
                    "type": "string"
                },
                "updated_at": {
                    "type": "string"
                }
            }
        },
        "domain.UserSummary": {
            "type": "object",
            "properties": {
                "active": {
                    "type": "boolean"
                },
                "email": {
                    "type": "string"
                },
                "id": {
                    "type": "string"
                },
                "last_login_at": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "role": {
                    "$ref": "#/definitions/domain.Role"
                }
            }
        },
        "domain.VespaClusterInfo": {
            "type": "object",
            "properties": {
                "container_clusters": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.VespaContainerCluster"
                    }
                },
                "content_clusters": {
                    "description": "Parsed cluster information",
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.VespaContentCluster"
                    }
                },
                "hosts": {
                    "type": "array",
                    "items": {
                        "$ref": "#/definitions/domain.VespaHost"
                    }
                },
                "hosts_xml": {
                    "type": "string"
                },
                "our_schema_deployed": {
                    "description": "Our schema status",
                    "type": "boolean"
                },
                "schemas": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "services_xml": {
                    "description": "Raw XML content (for persistence and future reference)",
                    "type": "string"
                }
            }
        },
        "domain.VespaContainerCluster": {
            "type": "object",
            "properties": {
                "has_feed": {
                    "type": "boolean"
                },
                "has_query": {
                    "type": "boolean"
                },
                "id": {
                    "type": "string"
                },
                "nodes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "port": {
                    "type": "integer"
                }
            }
        },
        "domain.VespaContentCluster": {
            "type": "object",
            "properties": {
                "documents": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "id": {
                    "type": "string"
                },
                "nodes": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                },
                "redundancy": {
                    "type": "integer"
                }
            }
        },
        "domain.VespaHost": {
            "type": "object",
            "properties": {
                "alias": {
                    "type": "string"
                },
                "hostname": {
                    "type": "string"
                }
            }
        },
        "domain.VespaSchemaMode": {
            "type": "string",
            "enum": [
                "",
                "bm25",
                "hybrid"
            ],
            "x-enum-varnames": [
                "VespacSchemaModeNone",
                "VespacSchemaModeBM25",
                "VespacSchemaModeHybrid"
            ]
        },
        "driving.AIServiceStatus": {
            "type": "object",
            "properties": {
                "available": {
                    "type": "boolean"
                },
                "embedding_dim": {
                    "description": "Only for embedding service",
                    "type": "integer"
                },
                "model": {
                    "type": "string"
                },
                "provider": {
                    "$ref": "#/definitions/domain.AIProvider"
                }
            }
        },
        "driving.AISettingsStatus": {
            "type": "object",
            "properties": {
                "effective_search_mode": {
                    "$ref": "#/definitions/domain.SearchMode"
                },
                "embedding": {
                    "$ref": "#/definitions/driving.AIServiceStatus"
                },
                "llm": {
                    "$ref": "#/definitions/driving.AIServiceStatus"
                },
                "vespa": {
                    "$ref": "#/definitions/driving.VespaServiceStatus"
                }
            }
        },
        "driving.ConnectVespaRequest": {
            "type": "object",
            "properties": {
                "dev_mode": {
                    "description": "DevMode controls deployment behavior:\n- true: Deploy our full app package (services.xml + schema) - for local development\n- false: Fetch existing app package, add our schema, redeploy - for production clusters",
                    "type": "boolean"
                },
                "endpoint": {
                    "description": "Endpoint is the Vespa cluster endpoint (optional, uses stored/default if empty)",
                    "type": "string"
                }
            }
        },
        "driving.CreateSourceRequest": {
            "type": "object",
            "properties": {
                "config": {
                    "$ref": "#/definitions/domain.SourceConfig"
                },
                "name": {
                    "type": "string"
                },
                "provider_type": {
                    "$ref": "#/definitions/domain.ProviderType"
                }
            }
        },
        "driving.CreateUserRequest": {
            "type": "object",
            "properties": {
                "email": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                },
                "role": {
                    "$ref": "#/definitions/domain.Role"
                }
            }
        },
        "driving.EmbeddingSettingsInput": {
            "type": "object",
            "properties": {
                "api_key": {
                    "type": "string"
                },
                "base_url": {
                    "type": "string"
                },
                "model": {
                    "type": "string"
                },
                "provider": {
                    "$ref": "#/definitions/domain.AIProvider"
                }
            }
        },
        "driving.LLMSettingsInput": {
            "type": "object",
            "properties": {
                "api_key": {
                    "type": "string"
                },
                "base_url": {
                    "type": "string"
                },
                "model": {
                    "type": "string"
                },
                "provider": {
                    "$ref": "#/definitions/domain.AIProvider"
                }
            }
        },
        "driving.SetupRequest": {
            "type": "object",
            "properties": {
                "email": {
                    "type": "string"
                },
                "name": {
                    "type": "string"
                },
                "password": {
                    "type": "string"
                }
            }
        },
        "driving.SetupResponse": {
            "type": "object",
            "properties": {
                "message": {
                    "type": "string"
                },
                "user": {
                    "$ref": "#/definitions/domain.User"
                }
            }
        },
        "driving.UpdateAISettingsRequest": {
            "type": "object",
            "properties": {
                "embedding": {
                    "$ref": "#/definitions/driving.EmbeddingSettingsInput"
                },
                "llm": {
                    "$ref": "#/definitions/driving.LLMSettingsInput"
                }
            }
        },
        "driving.UpdateSettingsRequest": {
            "type": "object",
            "properties": {
                "ai_endpoint": {
                    "type": "string"
                },
                "ai_provider": {
                    "$ref": "#/definitions/domain.AIProvider"
                },
                "auto_suggest_enabled": {
                    "type": "boolean"
                },
                "default_search_mode": {
                    "$ref": "#/definitions/domain.SearchMode"
                },
                "embedding_model": {
                    "type": "string"
                },
                "results_per_page": {
                    "type": "integer"
                },
                "semantic_search_enabled": {
                    "type": "boolean"
                },
                "sync_enabled": {
                    "type": "boolean"
                },
                "sync_interval_minutes": {
                    "type": "integer"
                }
            }
        },
        "driving.VespaServiceStatus": {
            "type": "object",
            "properties": {
                "can_upgrade": {
                    "type": "boolean"
                },
                "connected": {
                    "type": "boolean"
                },
                "embedding_dim": {
                    "type": "integer"
                },
                "embeddings_enabled": {
                    "type": "boolean"
                },
                "healthy": {
                    "type": "boolean"
                },
                "schema_mode": {
                    "$ref": "#/definitions/domain.VespaSchemaMode"
                }
            }
        },
        "driving.VespaStatus": {
            "type": "object",
            "properties": {
                "can_upgrade": {
                    "description": "CanUpgrade indicates if schema can be upgraded to hybrid",
                    "type": "boolean"
                },
                "cluster_info": {
                    "description": "ClusterInfo contains parsed information about the Vespa cluster (production mode only)",
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.VespaClusterInfo"
                        }
                    ]
                },
                "connected": {
                    "description": "Connected indicates if Vespa is reachable and schema is deployed",
                    "type": "boolean"
                },
                "dev_mode": {
                    "description": "DevMode indicates if we deployed full app package (true) or just added schema (false)",
                    "type": "boolean"
                },
                "embedding_dim": {
                    "description": "EmbeddingDim is the embedding dimension if embeddings are enabled",
                    "type": "integer"
                },
                "embedding_provider": {
                    "description": "EmbeddingProvider is the provider used for embeddings",
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.AIProvider"
                        }
                    ]
                },
                "embeddings_enabled": {
                    "description": "EmbeddingsEnabled indicates if hybrid search is available",
                    "type": "boolean"
                },
                "endpoint": {
                    "description": "Endpoint is the Vespa cluster endpoint",
                    "type": "string"
                },
                "healthy": {
                    "description": "Healthy indicates if the Vespa cluster is healthy",
                    "type": "boolean"
                },
                "reindex_required": {
                    "description": "ReindexRequired indicates if documents need reindexing",
                    "type": "boolean"
                },
                "schema_mode": {
                    "description": "SchemaMode indicates the deployed schema type (bm25, hybrid)",
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.VespaSchemaMode"
                        }
                    ]
                },
                "schema_version": {
                    "description": "SchemaVersion is the deployed schema version",
                    "type": "string"
                }
            }
        },
        "http.ErrorResponse": {
            "description": "API error response",
            "type": "object",
            "properties": {
                "error": {
                    "type": "string",
                    "example": "invalid request body"
                }
            }
        },
        "http.StatusResponse": {
            "description": "Simple status response",
            "type": "object",
            "properties": {
                "status": {
                    "type": "string",
                    "example": "ok"
                }
            }
        },
        "http.SyncAcceptedResponse": {
            "description": "Sync accepted response",
            "type": "object",
            "properties": {
                "source_id": {
                    "type": "string",
                    "example": "src_abc123"
                },
                "status": {
                    "type": "string",
                    "example": "accepted"
                }
            }
        },
        "http.VersionResponse": {
            "description": "API version response",
            "type": "object",
            "properties": {
                "version": {
                    "type": "string",
                    "example": "1.0.0"
                }
            }
        },
        "http.aiProviderInfo": {
            "description": "AI provider configuration status",
            "type": "object",
            "properties": {
                "base_url": {
                    "type": "string",
                    "example": "https://api.openai.com/v1"
                },
                "has_api_key": {
                    "type": "boolean",
                    "example": true
                },
                "is_configured": {
                    "type": "boolean",
                    "example": true
                },
                "model": {
                    "type": "string",
                    "example": "text-embedding-3-small"
                },
                "provider": {
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.AIProvider"
                        }
                    ],
                    "example": "openai"
                }
            }
        },
        "http.aiSettingsResponse": {
            "type": "object",
            "properties": {
                "embedding": {
                    "$ref": "#/definitions/http.aiProviderInfo"
                },
                "llm": {
                    "$ref": "#/definitions/http.aiProviderInfo"
                }
            }
        },
        "http.searchRequest": {
            "description": "Search query request",
            "type": "object",
            "properties": {
                "limit": {
                    "type": "integer",
                    "example": 20
                },
                "mode": {
                    "enum": [
                        "hybrid",
                        "text",
                        "semantic"
                    ],
                    "allOf": [
                        {
                            "$ref": "#/definitions/domain.SearchMode"
                        }
                    ],
                    "example": "hybrid"
                },
                "offset": {
                    "type": "integer",
                    "example": 0
                },
                "query": {
                    "type": "string",
                    "example": "how to configure authentication"
                },
                "source_ids": {
                    "type": "array",
                    "items": {
                        "type": "string"
                    }
                }
            }
        }
    },
    "securityDefinitions": {
        "BearerAuth": {
            "description": "JWT Bearer token. Format: \"Bearer {token}\"",
            "type": "apiKey",
            "name": "Authorization",
            "in": "header"
        }
    }
}